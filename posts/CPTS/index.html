<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Certified Penetration Testing Specialist Notes" /><meta property="og:locale" content="en" /><meta name="description" content="Network Enumeration with Nmap" /><meta property="og:description" content="Network Enumeration with Nmap" /><link rel="canonical" href="https://ahmedel-rayes.github.io/posts/CPTS/" /><meta property="og:url" content="https://ahmedel-rayes.github.io/posts/CPTS/" /><meta property="og:site_name" content="Anubis-Sec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-31T11:12:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Certified Penetration Testing Specialist Notes" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-02T02:26:51-05:00","datePublished":"2023-03-31T11:12:00-05:00","description":"Network Enumeration with Nmap","headline":"Certified Penetration Testing Specialist Notes","mainEntityOfPage":{"@type":"WebPage","@id":"https://ahmedel-rayes.github.io/posts/CPTS/"},"url":"https://ahmedel-rayes.github.io/posts/CPTS/"}</script><title>Certified Penetration Testing Specialist Notes | Anubis-Sec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Anubis-Sec"><meta name="application-name" content="Anubis-Sec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/anubis.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Anubis-Sec</a></div><div class="site-subtitle font-italic">“Ask, and it shall be given you; seek, and ye shall find; knock, and it shall be opened unto you”</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/AhmedEl-Rayes" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['aelrayes00','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/ahmedelrayes00/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Certified Penetration Testing Specialist Notes</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Certified Penetration Testing Specialist Notes</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1680279120" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 31, 2023 </em> </span> <span> Updated <em class="" data-ts="1680420411" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 2, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/AhmedEl-Rayes">Ahmed El-Rayes</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3921 words"> <em>21 min</em> read</span></div></div></div><div class="post-content"><h2 id="network-enumeration-with-nmap"><span class="mr-2">Network Enumeration with Nmap</span><a href="#network-enumeration-with-nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Nmap is one of the most used tools by network admins and IT security specialists, it can be used to Audit the security aspects of networks, simulate penetration tests, check firewall and IDS settings and configurations, test types of possible connections, network mapping, response analysis, identify open ports, and vulnerability assessments as well. Nmap offers many different types of scans, and can basically be divided into: Host Discovery, Port Scanning, Service Enumeration and Detection, OS Detection, and scriptable interactions with the target service through the nmap scripting engine. The basic syntax for nmap is</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap &lt;scan types&gt; &lt;options&gt; &lt;target&gt;
</pre></table></code></div></div><p>The TCP-SYN (<code class="language-plaintext highlighter-rouge">-sS</code>) is one of the default settings and is one of the most popular scan methods. This scan method makes it possible to scan thousands of ports per second. The TCP-SYN scan sends one packet with the SYN flag, and never completes the 3-way handshake.</p><p>-If the target responds with <code class="language-plaintext highlighter-rouge">SYN-ACK</code>, nmap detects the port as <code class="language-plaintext highlighter-rouge">open</code></p><p>-If the packet receives an <code class="language-plaintext highlighter-rouge">RST</code> flag, it is an indication that the port is <code class="language-plaintext highlighter-rouge">closed</code>.</p><p>-If Nmap does not receive a packet back, it will display the port as <code class="language-plaintext highlighter-rouge">filtered</code>. Depending on the firewall configuration, certain packets may be dropped or ignored by the firewall.</p><h3 id="host-discovery"><span class="mr-2">Host Discovery</span><a href="#host-discovery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>A basic scan that can be used to search a subnet for alive hosts is</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap 10.129.2.0/24 <span class="nt">-sn</span> <span class="nt">-oA</span> tnet | <span class="nb">grep </span><span class="k">for</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s2">" "</span> <span class="nt">-f5</span>
</pre></table></code></div></div><p>where <code class="language-plaintext highlighter-rouge">-sn</code> disables port scanning, and <code class="language-plaintext highlighter-rouge">-oA tnet</code> will output the results in all formats starting with the name <code class="language-plaintext highlighter-rouge">tnet</code>. We can also scan hosts from a list using the <code class="language-plaintext highlighter-rouge">-iL hosts.txt</code> option, where <code class="language-plaintext highlighter-rouge">hosts.txt</code> is a list of hosts, 1 per line. If we disable the port scan (with <code class="language-plaintext highlighter-rouge">-sn</code>), Nmap automatically will ping scan with <code class="language-plaintext highlighter-rouge">ICMP Echo Requests (-PE)</code>, where nmap will expect an <code class="language-plaintext highlighter-rouge">ICMP Reply</code> if the host is alive. We can confirm this with the <code class="language-plaintext highlighter-rouge">--packet-trace</code> option to ensure the ICMP echo requests are sent. Another way to determine why nmap has marked a host alive is with the <code class="language-plaintext highlighter-rouge">--reason</code> option.</p><h3 id="host-and-port-scanning"><span class="mr-2">Host and Port Scanning</span><a href="#host-and-port-scanning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>There are a total of 6 different states for scanned ports that we can obtain.</p><div class="table-wrapper"><table><thead><tr><th>State<th>Description<tbody><tr><td>Open<td>This indicates that the connection to the scanned port has been established. These connections can be TCP connections, UDP datagrams as well as SCTP associations.<tr><td>Closed<td>When the port is shown as closed, the TCP protocol indicates that the packet we received back contains an RST flag. This scanning method can also be used to determine if our target is alive or not.<tr><td>Filtered<td>Nmap cannot correctly identify whether the scanned port is open or closed because either no response is returned from the target for the port or we get an error code from the target.<tr><td>Unfiltered<td>This state of a port only occurs during the TCP-ACK scan and means that the port is accessible, but it cannot be determined whether it is open or closed.<tr><td>Open|Filtered<td>If we do not get a response for a specific port, Nmap will set it to that state. This indicates that a firewall or packet filter may protect the port.<tr><td>Closed|Filtered<td>This state only occurs in the IP ID idle scans and indicates that it was impossible to determine if the scanned port is closed or filtered by a firewall.</table></div><p>We can use the <code class="language-plaintext highlighter-rouge">--top-ports=x</code> flag to scan for x top ports, <code class="language-plaintext highlighter-rouge">-p 21</code> to scan only port 21, or <code class="language-plaintext highlighter-rouge">-p-</code> to scan all ports, or <code class="language-plaintext highlighter-rouge">-F</code> for top 100 ports (fast scan). Also <code class="language-plaintext highlighter-rouge">-n</code> can be used to disable DNS resolution.</p><h4 id="connect-scan"><span class="mr-2">Connect Scan</span><a href="#connect-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The nmap <code class="language-plaintext highlighter-rouge">TCP Connect Scan (-sT)</code> uses the TCP 3-way handshake to determine if a specific port on a target is open or closed. The <code class="language-plaintext highlighter-rouge">Connect Scan</code> is useful because it is the most accurate way to determine the state of a port, and it is also the most stealthy, unlike other types of scans, such as the SYN scan, the connect scan does not leave any unfinished connections or unsent packets on the target host, which makes it less likely to be detected by IDS or IPS, and is useful when you want to scan a network but don’t want to disturb the services running behind it.</p><h4 id="filtered-ports"><span class="mr-2">Filtered Ports</span><a href="#filtered-ports" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>When a port is shown as filtered, it can be shown this way for several reasons, in most cases, firewalls have certain rules set to handle specific connections, The packets can either be dropped or rejected. When a packet gets dropped, nmap receives no response from our target, and marks the port as filtered. These will require further investigation later on, but for now there is no way to interact with the port.</p><h4 id="discovering-open-udp-ports"><span class="mr-2">Discovering Open UDP Ports</span><a href="#discovering-open-udp-ports" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Since UDP is a stateless protocol, we do not receive any acknowledgment, consequently, the timeout is much longer, making UDP scans (<code class="language-plaintext highlighter-rouge">-sU</code>) Much slower than TCP scans. If the UDP port is open, we will only get a response if the application is configured to do so. If we get an ICMP response with <code class="language-plaintext highlighter-rouge">error code 3</code> (port unreachable) we know that the port is indeed closed.</p><h3 id="saving-results"><span class="mr-2">Saving Results</span><a href="#saving-results" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">-oN</code> for Normal output, <code class="language-plaintext highlighter-rouge">-oG</code> for Grepable output, and <code class="language-plaintext highlighter-rouge">-oX</code> for XML output. or <code class="language-plaintext highlighter-rouge">-oA</code> for all formats. With the XML output, we can easily create HTML reports that are useful for documentation as it presents the results in a detailed and clear way. To convert from XML to HTML we can use the tool <code class="language-plaintext highlighter-rouge">xsltproc</code> as such:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>xsltproc target.xml <span class="nt">-o</span> target.html
</pre></table></code></div></div><h3 id="service-enumeration"><span class="mr-2">Service Enumeration</span><a href="#service-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">-sV</code> can be used to enumerate versions, after a successful 3-way handshake, the server often sends a banner for identification. This serves to let the client know which service it is working with. At the Network level, this happens with a PSH flag in the TCP header. However, some services may not provide this information immediately. We can use <code class="language-plaintext highlighter-rouge">nc -nv ip port</code> to grab the banner.</p><p>An example packet capture looks like this</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>18:28:07.128564 IP 10.10.14.2.59618 <span class="o">&gt;</span> 10.129.2.28.smtp: Flags <span class="o">[</span>S], <span class="nb">seq </span>1798872233, win 65535, options <span class="o">[</span>mss 1460,nop,wscale 6,nop,nop,TS val 331260178 ecr 0,sackOK,eol], length 0

18:28:07.255151 IP 10.129.2.28.smtp <span class="o">&gt;</span> 10.10.14.2.59618: Flags <span class="o">[</span>S.], <span class="nb">seq </span>1130574379, ack 1798872234, win 65160, options <span class="o">[</span>mss 1460,sackOK,TS val 1800383922 ecr 331260178,nop,wscale 7], length 0

18:28:07.255281 IP 10.10.14.2.59618 <span class="o">&gt;</span> 10.129.2.28.smtp: Flags <span class="o">[</span>.], ack 1, win 2058, options <span class="o">[</span>nop,nop,TS val 331260304 ecr 1800383922], length 0

18:28:07.319306 IP 10.129.2.28.smtp <span class="o">&gt;</span> 10.10.14.2.59618: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:36, ack 1, win 510, options <span class="o">[</span>nop,nop,TS val 1800383985 ecr 331260304], length 35: SMTP: 220 inlane ESMTP Postfix <span class="o">(</span>Ubuntu<span class="o">)</span>

18:28:07.319426 IP 10.10.14.2.59618 <span class="o">&gt;</span> 10.129.2.28.smtp: Flags <span class="o">[</span>.], ack 36, win 2058, options <span class="o">[</span>nop,nop,TS val 331260368 ecr 1800383985], length 0
</pre></table></code></div></div><p>Where <code class="language-plaintext highlighter-rouge">S</code> is SYN, <code class="language-plaintext highlighter-rouge">S.</code> is SYN-ACK, <code class="language-plaintext highlighter-rouge">.</code> is ACK, <code class="language-plaintext highlighter-rouge">P.</code> is PSH-ACK, and <code class="language-plaintext highlighter-rouge">.</code> ACK confirms the receipt of the data at the end.</p><h3 id="nmap-scripting-engine"><span class="mr-2">Nmap Scripting Engine</span><a href="#nmap-scripting-engine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>There are a total of 14 categories of scripts</p><div class="table-wrapper"><table><thead><tr><th>Category<th>Description<tbody><tr><td>Auth<td>Determination of authentication credentials.<tr><td>Broadcast<td>Scripts, which are used for host discovery by broadcasting and the discovered hosts, can be automatically added to the remaining scans.<tr><td>brute<td>Executes scripts that try to log in to the respective service by brute-forcing with credentials.<tr><td>default<td>Default scripts executed by using the -sC option.<tr><td>discovery<td>Evaluation of accessible services.<tr><td>dos<td>These scripts are used to check services for denial of service vulnerabilities and are used less as it harms the services.<tr><td>exploit<td>This category of scripts tries to exploit known vulnerabilities for the scanned port.<tr><td>external<td>Scripts that use external services for further processing.<tr><td>fuzzer<td>This uses scripts to identify vulnerabilities and unexpected packet handling by sending different fields, which can take much time.<tr><td>intrusive<td>Intrusive scripts that could negatively affect the target system.<tr><td>malware<td>Checks if some malware infects the target system.<tr><td>safe<td>Defensive scripts that do not perform intrusive and destructive access.<tr><td>version<td>Extension for service detection.<tr><td>vuln<td>Identification of specific vulnerabilities.</table></div><p>There are several way to define the desired scripts in nmap</p><h4 id="default-scripts"><span class="mr-2">Default Scripts</span><a href="#default-scripts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap &lt;target&gt; <span class="nt">-sC</span>
</pre></table></code></div></div><h4 id="specific-scripts-category"><span class="mr-2">Specific Scripts Category</span><a href="#specific-scripts-category" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap &lt;target&gt; <span class="nt">--script</span> &lt;category&gt;
</pre></table></code></div></div><h4 id="defined-scripts"><span class="mr-2">Defined Scripts</span><a href="#defined-scripts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap &lt;target&gt; <span class="nt">--script</span> &lt;script-name&gt;,&lt;script-name&gt;,...
</pre></table></code></div></div><h4 id="nmap-aggressive-scan"><span class="mr-2">Nmap Aggressive scan</span><a href="#nmap-aggressive-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap &lt;ip&gt; <span class="nt">-p</span> &lt;port&gt; <span class="nt">-A</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">-A</code> will perform service detection, OS detection, traceroute, and uses default scripts to scan the target</p><h4 id="vulnerability-assessment"><span class="mr-2">Vulnerability Assessment</span><a href="#vulnerability-assessment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap &lt;port&gt; <span class="nt">-p</span> &lt;ip&gt; <span class="nt">-sV</span> <span class="nt">--script</span> vuln
</pre></table></code></div></div><p>These scripts interact with the service and find out more information about their versions and check various databases to see if there are known vulnerabilities.</p><h3 id="performance"><span class="mr-2">Performance</span><a href="#performance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>There are many options for telling Nmap how fast (<code class="language-plaintext highlighter-rouge">-T &lt;1-5&gt;</code>), with which frequency (<code class="language-plaintext highlighter-rouge">--min-parallelism &lt;number&gt;</code>), which timeouts (<code class="language-plaintext highlighter-rouge">--max-rtt-timeout &lt;time&gt;</code>) the test packets should have, how many packets should be sent simultaneously (<code class="language-plaintext highlighter-rouge">--min-rate &lt;number&gt;</code>), and with the number of retries (<code class="language-plaintext highlighter-rouge">--max-retries &lt;number&gt;</code>) for the scanned ports that the targets should be scanned.</p><h4 id="timeouts"><span class="mr-2">Timeouts</span><a href="#timeouts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>WHen nmap sends a packet, it takes some time (<code class="language-plaintext highlighter-rouge">RTT=Round Trip Time</code>) to receive a response from the scanned port. Generally nmap starts with a high timeout of 100ms. 1 way to speed up a scan is by:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap 10.129.2.0/24 <span class="nt">-F</span> <span class="nt">--initial-rtt-timeout</span> 50ms <span class="nt">--max-rtt-timeout</span> 100ms
</pre></table></code></div></div><p>Were <code class="language-plaintext highlighter-rouge">--initial-rtt-timeout 50ms</code> sets the specified time value as initial RTT timeout, and <code class="language-plaintext highlighter-rouge">--max-rtt-timeout 100ms</code> sets the specified time value as maximum RTT timeout. However, too short of a time period may cause us to miss hosts in the output, so this exact command is not recommended.</p><h4 id="max-retries"><span class="mr-2">Max Retries</span><a href="#max-retries" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Another way to increase the scans’ speed is to specify the retry rate. The default value is 10 but we can reduce this as such, which again can negatively impact the results:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap 10.129.2.0/24 <span class="nt">-F</span> <span class="nt">--max-retries</span> 0
</pre></table></code></div></div><h4 id="rates"><span class="mr-2">Rates</span><a href="#rates" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>During an engagement, we might get whitelisted, and the network might have ample bandwidth to support such scanning, we can really speed things up with:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap 10.129.2.0/24 <span class="nt">-F</span> <span class="nt">-oN</span> tnet.minrate300 <span class="nt">--min-rate</span> 300
</pre></table></code></div></div><h4 id="timing"><span class="mr-2">Timing</span><a href="#timing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>nmap offers 6 different timing templates <code class="language-plaintext highlighter-rouge">-T &lt;0-5&gt;</code> for us to use. The higher the value, the more aggressive the scan. We can experience negative effects if we scan too fast, like missing hosts or getting picked up/blocked by security systems. The default timing nmap uses is <code class="language-plaintext highlighter-rouge">-T 3</code>.</p><ul><li><p>-T 0 / -T Paranoid</p><li><p>-T 1 / -T Sneaky</p><li><p>-T 2 / -T Polite</p><li><p>-T 3 / -T Normal</p><li><p>-T 4 / Aggressive</p><li><p>-T 5 / Insane</p></ul><h3 id="firewall-and-idsidp-evasion"><span class="mr-2">Firewall and IDS/IDP Evasion</span><a href="#firewall-and-idsidp-evasion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Firewalls are software components that monitor network traffic between the firewall and incoming data connections, and decides how to handle the connection based on pre-defined rules that have been set. Similarly, an IDS will scan the network for potential attacks, analyze them, and report any detected attacks. An IPS compliments an IDS by taking specific defensive measures, should an attack be detected. The analysis of such attacks is based on pattern matching and signatures.</p><h4 id="determine-firewalls-and-their-rules"><span class="mr-2">Determine Firewalls and Their Rules</span><a href="#determine-firewalls-and-their-rules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>When a port is shown as filtered, it can have several reasons. In most cases, firewalls have certain rules set to handle specific connections. The packets can either be <code class="language-plaintext highlighter-rouge">dropped</code> or <code class="language-plaintext highlighter-rouge">rejected</code>. <code class="language-plaintext highlighter-rouge">dropped</code> packets are ignored, and no response is returned from the host. On the other hand, <code class="language-plaintext highlighter-rouge">rejected</code> packets are returned with an <code class="language-plaintext highlighter-rouge">RST</code> flag. These packets contain different types of <code class="language-plaintext highlighter-rouge">ICMP error codes</code>, or contain nothing at all. Such errors can be:</p><ul><li><p>Net Unreachable</p><li><p>Net Prohibited</p><li><p>Host Unreachable</p><li><p>Host Prohibited</p><li><p>Port Unreachable</p><li><p>Port Prohibited</p></ul><p>Nmap’s TCP ACK (<code class="language-plaintext highlighter-rouge">-sA</code>) method is much harder to filter for firewalls and IDS/IPS systems compared to regular SYN (<code class="language-plaintext highlighter-rouge">-sS</code>) or (<code class="language-plaintext highlighter-rouge">-sT</code>) because they send a TCP packet with only the <code class="language-plaintext highlighter-rouge">ACK</code> flag. Packets with the <code class="language-plaintext highlighter-rouge">ACK</code> flag are usually passed by the firewall because it can not determine whether the connection was first established from the external or the internal network.</p><h4 id="detect-idsips"><span class="mr-2">Detect IDS/IPS</span><a href="#detect-idsips" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Detection of IDS/IPS is much more difficult because these are passive traffic monitoring systems. If you get picked up by an IDS/IPS, proceeding with the test will be much more difficult, as your ISP may be notified and your internet will be revoked, or you may just be blocked from the target environment. Ideally, you would have access to several VPS’s with different IPs to determine whether such systems are on the target network during a pentest, if one gets blocked, you would need to use the others in a more careful and stealthy manner.</p><h4 id="decoys"><span class="mr-2">Decoys</span><a href="#decoys" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>There are cases in which admins block specific subnets from different regions. This prevents any access to the target network. Another example is if an IPS exists and blocks us. For this reason, the Decoy Scanning Method (<code class="language-plaintext highlighter-rouge">-D</code>) is the right choice. With this method, nmap generates various random IP addresses inserted into the IP header to disguise the origin of the packet sent. It is critical that the decoys must be alive, otherwise the service on the target may be unreachable due to SYN-flooding security mechanisms.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap 10.129.2.28 <span class="nt">-p</span> 80 <span class="nt">-sS</span> <span class="nt">-D</span> RND:5
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">RND:5</code> generates five random IP addresses that indicates the source IP the connection comes from.</p><p>We can also use <code class="language-plaintext highlighter-rouge">-S</code> to specify a source IP, because it may be possible that specific subnets are blocked from accessing the resource, we can try our luck with another:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap 10.129.2.28 <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">-p</span> 445 <span class="nt">-O</span> <span class="nt">-S</span> 10.129.2.200 <span class="nt">-e</span> tun0
</pre></table></code></div></div><h4 id="dns-proxying"><span class="mr-2">DNS Proxying</span><a href="#dns-proxying" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>DNS queries are traditionally made over UDP port 53, however due to IPv6 and DNSSEC expansions, many DNS requests are made over TCP port 53 now. Nmap gives us a way to specify DNS servers ourselves (<code class="language-plaintext highlighter-rouge">--dns-server &lt;ns&gt;,&lt;ns&gt;</code>). This method could be important to us if we are in a DMZ. The company’s DNS servers are usually more trusted than online ones, so for example we could use them to interact with the hosts of the internal network. We could make TCP port 53 our source port (<code class="language-plaintext highlighter-rouge">--source-port</code>) for our scans. If an admin uses the firewall to control this port and does not filter IDS/IPS properly, our TCP packets will be trusted and passed through.</p><h5 id="connect-to-the-filtered-port"><span class="mr-2">Connect to the Filtered Port</span><a href="#connect-to-the-filtered-port" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>If we discover that the firewall allows traffic from TCP port 53, we can use netcat to establish a connection as such</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ncat <span class="nt">-nv</span> <span class="nt">--source-port</span> 53 &lt;ip&gt; &lt;port&gt;
</pre></table></code></div></div><h2 id="footprinting"><span class="mr-2">Footprinting</span><a href="#footprinting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="ftp"><span class="mr-2">FTP</span><a href="#ftp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Client and Server establish control channel through <code class="language-plaintext highlighter-rouge">TCP port 21</code>. The client sends commands to the server, and the server responds status codes, then both the client and server can establish a data channel over <code class="language-plaintext highlighter-rouge">TCP port 20</code>, which is used exclusively for data transmission.</p><h4 id="tftp"><span class="mr-2">TFTP</span><a href="#tftp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Trivial File Transfer Protocol is simpler than FTP and performs file transfers between client and server processes, however it does not provide user authentication and other features supported by FTP. While FTP uses TCP, TFTP uses UDP, making it unreliable for data transfers. Here are a few commands in TFTP:</p><div class="table-wrapper"><table><thead><tr><th>Commands<th>Description<tbody><tr><td>Connect<td>Sets the remote host, and optionally the port, for file transfers<tr><td>Get<td>Transfers a file or set of files from the remote host to the local host<tr><td>Put<td>Transfers a file or set of files from the local host onto the remote host<tr><td>Quit<td>exits TFTP<tr><td>Status<td>Shows the current status, like transfer mode (ascii or binary), connection status, time-out value, and so on<tr><td>Verbose<td>Turns verbose mode on, which displays additional information</table></div><p>Unlike FTP, TFTP does not have a directory listing functionality</p><h4 id="default-configuration-of-vsftpd"><span class="mr-2">Default Configuration of vsFTPd</span><a href="#default-configuration-of-vsftpd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>One of the most used FTP servers in linux-based distros is <code class="language-plaintext highlighter-rouge">vsFTPd</code>. The default config can be found in <code class="language-plaintext highlighter-rouge">/etc/vsftpd.conf</code></p><div class="table-wrapper"><table><thead><tr><th>Setting<th>Description<tbody><tr><td>listen=NO<td>Run from inetd or as a standalone daemon?<tr><td>listen_ipv6=YES<td>Listen on IPv6 ?<tr><td>anonymous_enable=NO<td>Enable Anonymous access?<tr><td>dirmessage_enable=YES<td>Display active directory messages when users go into certain directories?<tr><td>use_localtime=YES<td>Use local time?<tr><td>xferlog_enable=YES<td>Activate logging of uploads/downloads?<tr><td>connect_from_port_20=YES<td>Connect from port 20?<tr><td>secure_chroot_dir=/var/run/vsftpd/empty<td>Name of an empty directory<tr><td>pam_service_name=vsftpd<td>This string is the name of the PAM service vsftpd will use.<tr><td>rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem<td>The last three options specify the location of the RSA certificate to use for SSL encrypted connections.<tr><td>rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key<td> <tr><td>ssl_enable=NO<td> </table></div><p>There is also a file <code class="language-plaintext highlighter-rouge">/etc/ftpusers</code> that is used to deny certain users access to FTP service. Users in this file are <code class="language-plaintext highlighter-rouge">not</code> allowed to log in to the FTP service.</p><h5 id="dangerous-settings"><span class="mr-2">Dangerous Settings</span><a href="#dangerous-settings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>One of the most common things to test for when testing FTP is anonmyous access, these settings look like this:</p><div class="table-wrapper"><table><thead><tr><th>Setting<th>Description<tbody><tr><td>anonymous_enable=YES<td>Allowing anonymous login?<tr><td>anon_upload_enable=YES<td>Allowing anonymous to upload files?<tr><td>anon_mkdir_write_enable=YES<td>Allowing anonymous to create new directories?<tr><td>no_anon_password=YES<td>Do not ask anonymous for password?<tr><td>anon_root=/home/username/ftp<td>Directory for anonymous.<tr><td>write_enable=YES<td>Allow the usage of FTP commands: STOR, DELE, RNFR, RNTO, MKD, RMD, APPE, and SITE?</table></div><h4 id="logging-in-anonymously"><span class="mr-2">Logging in Anonymously</span><a href="#logging-in-anonymously" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ftp anonymous@&lt;ip address&gt;
</pre></table></code></div></div><h4 id="useful-commands-and-settings"><span class="mr-2">Useful Commands and Settings</span><a href="#useful-commands-and-settings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>A useful setting for protecting FTP is <code class="language-plaintext highlighter-rouge">hide_ids=YES</code>, which means the UID and GUID representation of the service will be overwritten, making it difficult for us to see the rights that these files have. This prevents local usernames from being revealed.</p><p>Another useful setting is <code class="language-plaintext highlighter-rouge">ls_recurse_enabled=YES</code>, if this is enabled we can do <code class="language-plaintext highlighter-rouge">ls -R</code> which will give us a better overview of the FTP directory structure.</p><p>We can download a file with <code class="language-plaintext highlighter-rouge">Get File\ Name.txt</code> where the name of the file is <code class="language-plaintext highlighter-rouge">File Name.txt</code>, the \ is used to escape the <code class="language-plaintext highlighter-rouge">space</code>.</p><p>We can also use wget to download all files recursively as such:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wget <span class="nt">-m</span> <span class="nt">--no-passive</span> ftp://anonymous:anonymous@&lt;ip address?
</pre></table></code></div></div><p>Or once logged in, we can <code class="language-plaintext highlighter-rouge">prompt OFF</code>, <code class="language-plaintext highlighter-rouge">recurse ON</code> and <code class="language-plaintext highlighter-rouge">mget *</code></p><p>We can Upload files with the <code class="language-plaintext highlighter-rouge">put</code> command, like this <code class="language-plaintext highlighter-rouge">put &lt;filename&gt;.ext</code></p><h4 id="footprinting-ftp"><span class="mr-2">Footprinting FTP</span><a href="#footprinting-ftp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>We can start by updating the nse database as such</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap <span class="nt">--script-updatedb</span>
</pre></table></code></div></div><p>All the NSE scripts are generally located in <code class="language-plaintext highlighter-rouge">/usr/share/nmap/scripts/</code>, or we can find them with this simple command</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>find / <span class="nt">-type</span> f <span class="nt">-name</span> ftp<span class="k">*</span> 2&gt;/dev/null | <span class="nb">grep </span>scripts
</pre></table></code></div></div><p>Which will return all nmap scripts that start with ftp.</p><h4 id="service-interaction"><span class="mr-2">Service Interaction</span><a href="#service-interaction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nc <span class="nt">-nv</span> &lt;ip&gt; 21
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>telnet &lt;ip&gt; 21
</pre></table></code></div></div><p>It is a little different if the FTP server runs with TLS/SSL encryption, as we need a client that can handle that. We can use <code class="language-plaintext highlighter-rouge">openssl</code> as such.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>openssl s_client <span class="nt">-connect</span> &lt;ip&gt;:21 <span class="nt">-starttls</span> ftp
</pre></table></code></div></div><h3 id="smb"><span class="mr-2">SMB</span><a href="#smb" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Useful commands for enumerating SMB are:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c">#anonymously list shares</span>
smbclient <span class="nt">-L</span> <span class="nt">-N</span> <span class="se">\\</span>&lt;IP/FQDN&gt;<span class="se">\ </span>

and 
<span class="c">#connect to a share anonymously</span>
smbclient <span class="nt">-N</span> <span class="se">\\</span>&lt;IP/FQDN&gt;<span class="se">\&lt;</span>share&gt;
</pre></table></code></div></div><p>We can also use rpcclient :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rpcclient <span class="nt">-U</span> <span class="s2">""</span> &lt;ip&gt;
</pre></table></code></div></div><p>Then some usual commands are,</p><p><code class="language-plaintext highlighter-rouge">srvinfo</code>-&gt; Server information.</p><p><code class="language-plaintext highlighter-rouge">enumdomains</code>-&gt; Enumerate all domains that are deployed in the network.</p><p><code class="language-plaintext highlighter-rouge">querydominfo</code>-&gt; Provides domain, server, and user information of deployed domains.</p><p><code class="language-plaintext highlighter-rouge">netshareenumall</code>-&gt; Enumerates all available shares.</p><p><code class="language-plaintext highlighter-rouge">netsharegetinfo &lt;share&gt;</code>-&gt; Provides information about a specific share.</p><p><code class="language-plaintext highlighter-rouge">enumdomusers</code>-&gt; Enumerates all domain users.</p><p><code class="language-plaintext highlighter-rouge">queryuser &lt;RID&gt;</code>-&gt; Provides information about a specific user.</p><p>We can do <code class="language-plaintext highlighter-rouge">enumdomusers</code>, grab the user and group rids, then <code class="language-plaintext highlighter-rouge">queryuser &lt;rid&gt;</code> or querygroup <code class="language-plaintext highlighter-rouge">rid</code></p><p>We can also use a tool from impacket <code class="language-plaintext highlighter-rouge">samrdump.py</code> to bruteforce RIDS as such:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>samrdump.py &lt;ip&gt;
</pre></table></code></div></div><p>Another useful tool is enum4linux, which we can use as</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./enum4linux-ng &lt;ip&gt; <span class="nt">-A</span>
</pre></table></code></div></div><h3 id="nfs"><span class="mr-2">NFS</span><a href="#nfs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Network File System has the same purpose as SMB, but it is only used between Linux and Unix systems, unlike SMB/Samba which are cross compatible with Windows/AD and Linux.</p><p>We can footprint the service with nmap</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap &lt;ip&gt; <span class="nt">-p111</span>,2049 <span class="nt">-sC</span> <span class="nt">-sV</span>
</pre></table></code></div></div><p>the rpcinfo NSE script retrieves a list of all currently running RPC services, their names and description, and the ports they use. Nmap also has some NSE scripts that we can run on NFS as such:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap <span class="nt">--script</span> nfs<span class="k">*</span> &lt;ip&gt; <span class="nt">-sV</span> <span class="nt">-p111</span>,2049
</pre></table></code></div></div><p>to show available NFS shares:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>showmount <span class="nt">-e</span> 10.129.14.128
</pre></table></code></div></div><p>And then to mount the share</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">mkdir </span>target-NFS
<span class="nb">sudo </span>mount <span class="nt">-t</span> nfs &lt;ip&gt;:/ ./target-NFS/ <span class="nt">-o</span> nolock
<span class="nb">cd </span>target-NFS
tree <span class="nb">.</span>
</pre></table></code></div></div><p>To unmount</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">cd</span> ..
<span class="nb">sudo </span>umount ./target-NFS
</pre></table></code></div></div><h3 id="dns"><span class="mr-2">DNS</span><a href="#dns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>There are several types of DNS servers:</p><p><code class="language-plaintext highlighter-rouge">DNS Root Server</code>- The root servers of the DNS are responsible for the top-level domains (TLD). As the last instance, they are only requested if the name server does not respond. Thus, a root server is a central interface between users and content on the Internet, as it links domain and IP address. The Internet Corporation for Assigned Names and Numbers (ICANN) coordinates the work of the root name servers. There are 13 such root servers around the globe.</p><p><code class="language-plaintext highlighter-rouge">Authoritative Nameserver</code>- Authoritative name servers hold authority for a particular zone. They only answer queries from their area of responsibility, and their information is binding. If an authoritative name server cannot answer a client’s query, the root name server takes over at that point.</p><p><code class="language-plaintext highlighter-rouge">Non-authoritative Nameserver</code>- Non-authoritative name servers are not responsible for a particular DNS zone. Instead, they collect information on specific DNS zones themselves, which is done using recursive or iterative DNS querying.</p><p><code class="language-plaintext highlighter-rouge">Caching DNS Server</code>- Caching DNS servers cache information from other name servers for a specified period. The authoritative name server determines the duration of this storage.</p><p><code class="language-plaintext highlighter-rouge">Forwarding Server</code>- Forwarding servers perform only one function: they forward DNS queries to another DNS server.</p><p><code class="language-plaintext highlighter-rouge">Resolver</code>- Resolvers are not authoritative DNS servers but perform name resolution locally in the computer or router.</p><p>There are also different DNS records used for DNS queries:</p><p><code class="language-plaintext highlighter-rouge">A</code>- Returns an IPv4 address of the requested domain as a result.</p><p><code class="language-plaintext highlighter-rouge">AAAA</code>-Returns an IPv6 address of the requested domain.</p><p><code class="language-plaintext highlighter-rouge">MX</code>-Returns the responsible mail servers as a result.</p><p><code class="language-plaintext highlighter-rouge">NS</code>-Returns the DNS servers (nameservers) of the domain.</p><p><code class="language-plaintext highlighter-rouge">TXT</code>-This record can contain various information. The all-rounder can be used, e.g., to validate the Google Search Console or validate SSL certificates. In addition, SPF and DMARC entries are set to validate mail traffic and protect it from spam.</p><p><code class="language-plaintext highlighter-rouge">CNAME</code>-This record serves as an alias. If the domain www.hackthebox.eu should point to the same IP, and we create an A record for one and a CNAME record for the other.</p><p><code class="language-plaintext highlighter-rouge">PTR</code>- The PTR record works the other way around (reverse lookup). It converts IP addresses into valid domain names.</p><p><code class="language-plaintext highlighter-rouge">SOA</code>- Provides information about the corresponding DNS zone and email address of the administrative contact.</p><h4 id="footprinting-dns"><span class="mr-2">Footprinting DNS</span><a href="#footprinting-dns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>NS Query</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dig ns &lt;domain&gt;.com @&lt;dns IP&gt;
</pre></table></code></div></div><p>Sometimes it is possible to query a DNS server’s version using a class CHAOS type query and type TXT. this entry must exist on the DNS server to work:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dig CH TXT version.bind &lt;dns ip&gt;
</pre></table></code></div></div><p>We can use the <code class="language-plaintext highlighter-rouge">ANY</code> to view all avaialbe records, which causes the service to disclose all available entries that it can share.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dig any &lt;domain&gt;.com @&lt;dns ip&gt;
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Zone Transfer</code> refers to the transfer of zones to another server in DNS, which usually happens over TCP port 53. This is abbreviated <code class="language-plaintext highlighter-rouge">Asynchronous Full Transfer Zone (AXFR)</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dig axfr &lt;domain&gt;.com @&lt;dns ip&gt;
</pre></table></code></div></div><p>or for internal</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dig axfr internal.&lt;domain&gt;.com @&lt;dns-ip&gt;
</pre></table></code></div></div><p>We can also use a for loop in bash to query for individual <code class="language-plaintext highlighter-rouge">A</code> records.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">for </span>sub <span class="k">in</span> <span class="si">$(</span><span class="nb">cat</span> /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-110000.txt<span class="si">)</span><span class="p">;</span><span class="k">do </span>dig <span class="nv">$sub</span>.inlanefreight.htb @10.129.14.128 | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">';\|SOA'</span> | <span class="nb">sed</span> <span class="nt">-r</span> <span class="s1">'/^\s*$/d'</span> | <span class="nb">grep</span> <span class="nv">$sub</span> | <span class="nb">tee</span> <span class="nt">-a</span> subdomains.txt<span class="p">;</span><span class="k">done</span>
</pre></table></code></div></div><p>Another tool that can do this is <code class="language-plaintext highlighter-rouge">DNSenum</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dnsenum <span class="nt">--dnsserver</span> &lt;dns-ip&gt; <span class="nt">--enum</span> <span class="nt">-p</span> 0 <span class="nt">-s</span> 0 <span class="nt">-o</span> subdomains.txt <span class="nt">-f</span> /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-110000.txt &lt;target domain&gt;.com
</pre></table></code></div></div><h3 id="smpt"><span class="mr-2">SMPT</span><a href="#smpt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To interact with SMTP, we can use <code class="language-plaintext highlighter-rouge">telnet</code> to initialize a TCP connection.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>telnet &lt;ip&gt;

Helo mail1.inlanefreight.htb
</pre></table></code></div></div><p>Depending how the server is configured, we can use the <code class="language-plaintext highlighter-rouge">VRFY</code> command to enumerate users</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>telnet &lt;ip&gt; 25

VRFY root
</pre></table></code></div></div><p>To send an email</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>telnet &lt;ip&gt; 25

EHLO inlanefreight.htb

MAIL FROM: &lt;goober@goober.htb&gt;

RCPT TO: &lt;goober2@goober.htb&gt; <span class="nv">NOTIFY</span><span class="o">=</span>success,failure

DATA

QUIT
</pre></table></code></div></div><h4 id="footprinting-smpt"><span class="mr-2">Footprinting SMPT</span><a href="#footprinting-smpt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap &lt;ip&gt; <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p25</span>
</pre></table></code></div></div><p>We can also use NSE’s <code class="language-plaintext highlighter-rouge">smtp-open-relay</code> script to identify if the target server can be used as an open relay.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap &lt;ip&gt; <span class="nt">-p25</span> <span class="nt">--script</span> smtp-open-relay
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/notes/'>notes</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >Windows</a> <a href="/tags/active-directory/" class="post-tag no-text-decoration" >Active Directory</a> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Certified+Penetration+Testing+Specialist+Notes+-+Anubis-Sec&url=https%3A%2F%2Fahmedel-rayes.github.io%2Fposts%2FCPTS%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Certified+Penetration+Testing+Specialist+Notes+-+Anubis-Sec&u=https%3A%2F%2Fahmedel-rayes.github.io%2Fposts%2FCPTS%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fahmedel-rayes.github.io%2Fposts%2FCPTS%2F&text=Certified+Penetration+Testing+Specialist+Notes+-+Anubis-Sec" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CPTS/">Certified Penetration Testing Specialist Notes</a><li><a href="/posts/CRTP/">Certified Red Team Professional Notes</a><li><a href="/posts/PortSwigger/">Port Swigger Academy Notes</a><li><a href="/posts/PNPT/">PNPT Notes</a><li><a href="/posts/ConsoleCowboy/">The Way of the Console Cowboy</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/outdated-software/">Outdated Software</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a> <a class="post-tag" href="/tags/hash-capture/">Hash Capture</a> <a class="post-tag" href="/tags/public-vulnerabilities/">Public Vulnerabilities</a> <a class="post-tag" href="/tags/weak-credentials/">Weak Credentials</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/anonymous-access/">Anonymous Access</a> <a class="post-tag" href="/tags/educational/">Educational</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CRTP/"><div class="card-body"> <em class="small" data-ts="1678224180" data-df="ll" > Mar 7, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Certified Red Team Professional Notes</h3><div class="text-muted small"><p> Certified Red Team Professional Notes Week 1 • Enumerate useful information like users, groups, group memberships, computers, user properties, trusts, ACLs etc. to map attack paths! • Learn and...</p></div></div></a></div><div class="card"> <a href="/posts/ConsoleCowboy/"><div class="card-body"> <em class="small" data-ts="1673368200" data-df="ll" > Jan 10, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The Way of the Console Cowboy</h3><div class="text-muted small"><p> Tips and Tricks for Navigating Linux tmux Tmux is a powerful screen multiplexer, meaning it lets you handle multiple panes in a command line interface, which is super useful for sys-admin tasks, ...</p></div></div></a></div><div class="card"> <a href="/posts/Querier/"><div class="card-body"> <em class="small" data-ts="1673380800" data-df="ll" > Jan 10, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Querier</h3><div class="text-muted small"><p> Querier is a medium level machine on HacktheBox that starts with discovering database credentials in the macros of a xlsm file on a network share. We can then login to the database as a low privele...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CRTP/" class="btn btn-outline-primary" prompt="Older"><p>Certified Red Team Professional Notes</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/AhmedEl-Rayes">Ahmed El-Rayes</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/outdated-software/">Outdated Software</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a> <a class="post-tag" href="/tags/hash-capture/">Hash Capture</a> <a class="post-tag" href="/tags/public-vulnerabilities/">Public Vulnerabilities</a> <a class="post-tag" href="/tags/weak-credentials/">Weak Credentials</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/anonymous-access/">Anonymous Access</a> <a class="post-tag" href="/tags/educational/">Educational</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
